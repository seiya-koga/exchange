
<script type="texr/javascript">
var dataSet = [];
 
// Ｘ，Ｙ軸を表示できるようにグラフの周囲にマージンを確保する
var margin = {top: 40, right: 40, bottom: 40, left: 100};
var width = 800 - margin.left - margin.right;
var height = 500 - margin.top - margin.bottom;
 
d3.csv("./js/WorldPopulation.csv", function(error, dataSet){
 
  // SVGの表示領域を生成
  var svg = d3.select("#MyGraph")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + ", " + margin.top + ")");
     
  // スケール関数を作成。
  var xScale = d3.scale.linear()
    .domain([1000,2200])
    .range([0,width]);
 
  var yScale = d3.scale.log()
    .domain([0.1,10])
    .range([height,0]);
 
  var line = d3.svg.line()
    .x(function(d,i){
      return xScale(d.Year);
    })
    .y(function(d,i){
      return yScale(d.Population);     
    });
 
  // 折れ線グラフを生成
  svg.append("path")
    .attr("class", "line")
    .attr("d", line(dataSet));
     
  // 散布図を描画
  svg.selectAll("circle")
    .data(dataSet)
    .enter()
    .append("circle")
    .attr("r", 5)
    .attr("cx", function(d){
      return xScale(d.Year);
    })
    .attr("cy", function(d){
      return yScale(d.Population);
    })
    .attr("fill","orange");
 
  // Ｙ軸を描画
  svg.append("g")
    .attr("class", "axis")
    .call(d3.svg
      .axis()
      .scale(yScale)
      .orient("left")
      .tickValues([0.1,0.2,0.4,0.6,0.8,1,2,4,8,10])
      .tickFormat(d3.format(".1f"))
  );
   
  // Ｘ軸を描画
  svg.append("g")
    .attr("class", "axis")
    .attr("transform", "translate(0," + height + ")")
    .call(d3.svg
      .axis()
      .scale(xScale)
      .orient("bottom")
      .tickFormat(function(d){return d;})
  );
   
  // 凡例
  svg.append("g")
    .attr("class", "axis")
    .append("text")
    .attr("x", 20)
    .attr("y", 20)
    .text("[単位： 10億人]");
 
  svg.append("g")
    .attr("class", "axis")
    .append("text")
    .attr("x", width/2)
    .attr("y", margin.top + height)
    .text("Year");
 
})

</script>